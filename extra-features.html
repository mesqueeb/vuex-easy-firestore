<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Extra features | Vuex Easy Firestore üî•</title>
    <meta name="generator" content="VuePress 1.4.1">
    
    <meta name="description" content="Easy coupling of firestore and vuex. 2-way sync with 0 boilerplate!">
    <link rel="preload" href="/vuex-easy-firestore/assets/css/0.styles.7e771a3c.css" as="style"><link rel="preload" href="/vuex-easy-firestore/assets/js/app.7865803c.js" as="script"><link rel="preload" href="/vuex-easy-firestore/assets/js/2.a44a5bbe.js" as="script"><link rel="preload" href="/vuex-easy-firestore/assets/js/8.14128c0a.js" as="script"><link rel="prefetch" href="/vuex-easy-firestore/assets/js/10.afce603d.js"><link rel="prefetch" href="/vuex-easy-firestore/assets/js/11.121d4951.js"><link rel="prefetch" href="/vuex-easy-firestore/assets/js/12.1a70acda.js"><link rel="prefetch" href="/vuex-easy-firestore/assets/js/13.65b1116f.js"><link rel="prefetch" href="/vuex-easy-firestore/assets/js/14.f676c9f6.js"><link rel="prefetch" href="/vuex-easy-firestore/assets/js/15.61ced602.js"><link rel="prefetch" href="/vuex-easy-firestore/assets/js/3.a50046c5.js"><link rel="prefetch" href="/vuex-easy-firestore/assets/js/4.e6717748.js"><link rel="prefetch" href="/vuex-easy-firestore/assets/js/5.b8d3685e.js"><link rel="prefetch" href="/vuex-easy-firestore/assets/js/6.89669ab9.js"><link rel="prefetch" href="/vuex-easy-firestore/assets/js/7.5de5c22a.js"><link rel="prefetch" href="/vuex-easy-firestore/assets/js/9.083d4adf.js">
    <link rel="stylesheet" href="/vuex-easy-firestore/assets/css/0.styles.7e771a3c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/vuex-easy-firestore/" class="home-link router-link-active"><!----> <span class="site-name">Vuex Easy Firestore üî•</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://github.com/mesqueeb/vuex-easy-firestore/releases" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Changelog
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/mesqueeb/vuex-easy-firestore" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://github.com/mesqueeb/vuex-easy-firestore/releases" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Changelog
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/mesqueeb/vuex-easy-firestore" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/vuex-easy-firestore/setup.html" class="sidebar-link">Installation &amp; setup</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuex-easy-firestore/setup.html#installation" class="sidebar-link">Installation</a></li><li class="sidebar-sub-header"><a href="/vuex-easy-firestore/setup.html#setup" class="sidebar-link">Setup</a></li><li class="sidebar-sub-header"><a href="/vuex-easy-firestore/setup.html#in-a-nutshell" class="sidebar-link">In a nutshell</a></li><li class="sidebar-sub-header"><a href="/vuex-easy-firestore/setup.html#first-steps" class="sidebar-link">First steps</a></li></ul></li><li><a href="/vuex-easy-firestore/add-and-manage-data.html" class="sidebar-link">Add and manage data</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuex-easy-firestore/add-and-manage-data.html#basic-usage" class="sidebar-link">Basic usage</a></li><li class="sidebar-sub-header"><a href="/vuex-easy-firestore/add-and-manage-data.html#collection-mode" class="sidebar-link">'collection' mode</a></li><li class="sidebar-sub-header"><a href="/vuex-easy-firestore/add-and-manage-data.html#doc-mode" class="sidebar-link">'doc' mode</a></li><li class="sidebar-sub-header"><a href="/vuex-easy-firestore/add-and-manage-data.html#batch-updates-inserts-deletions" class="sidebar-link">Batch updates/inserts/deletions</a></li><li class="sidebar-sub-header"><a href="/vuex-easy-firestore/add-and-manage-data.html#duplicating-docs" class="sidebar-link">Duplicating docs</a></li></ul></li><li><a href="/vuex-easy-firestore/query-data.html" class="sidebar-link">Read data</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuex-easy-firestore/query-data.html#realtime-updates-vs-single-fetch" class="sidebar-link">Realtime updates vs single fetch</a></li><li class="sidebar-sub-header"><a href="/vuex-easy-firestore/query-data.html#realtime-updates-opendbchannel" class="sidebar-link">Realtime updates: openDBChannel</a></li><li class="sidebar-sub-header"><a href="/vuex-easy-firestore/query-data.html#fetching-docs" class="sidebar-link">Fetching docs</a></li><li class="sidebar-sub-header"><a href="/vuex-easy-firestore/query-data.html#firestore-authentication" class="sidebar-link">Firestore authentication</a></li><li class="sidebar-sub-header"><a href="/vuex-easy-firestore/query-data.html#where-orderby-clauses" class="sidebar-link">where / orderBy clauses</a></li><li class="sidebar-sub-header"><a href="/vuex-easy-firestore/query-data.html#automatic-initial-doc-insertion" class="sidebar-link">Automatic initial doc insertion</a></li><li class="sidebar-sub-header"><a href="/vuex-easy-firestore/query-data.html#multiple-modules-with-2-way-sync" class="sidebar-link">Multiple modules with 2-way sync</a></li><li class="sidebar-sub-header"><a href="/vuex-easy-firestore/query-data.html#sync-directly-to-module-state" class="sidebar-link">Sync directly to module state</a></li><li class="sidebar-sub-header"><a href="/vuex-easy-firestore/query-data.html#manual-fetch-handling" class="sidebar-link">Manual fetch handling</a></li></ul></li><li><a href="/vuex-easy-firestore/firestore-fields-and-functions.html" class="sidebar-link">Firestore fields and functions</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuex-easy-firestore/firestore-fields-and-functions.html#arrayunion-and-arrayremove" class="sidebar-link">arrayUnion and arrayRemove</a></li><li class="sidebar-sub-header"><a href="/vuex-easy-firestore/firestore-fields-and-functions.html#increment" class="sidebar-link">increment</a></li><li class="sidebar-sub-header"><a href="/vuex-easy-firestore/firestore-fields-and-functions.html#delete-fields" class="sidebar-link">Delete fields</a></li></ul></li><li><a href="/vuex-easy-firestore/hooks.html" class="sidebar-link">Hooks</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuex-easy-firestore/hooks.html#hooks-on-local-changes" class="sidebar-link">Hooks on local changes</a></li><li class="sidebar-sub-header"><a href="/vuex-easy-firestore/hooks.html#hooks-after-local-changes-before-sync" class="sidebar-link">Hooks after local changes before sync</a></li><li class="sidebar-sub-header"><a href="/vuex-easy-firestore/hooks.html#hooks-after-server-changes" class="sidebar-link">Hooks after server changes</a></li><li class="sidebar-sub-header"><a href="/vuex-easy-firestore/hooks.html#hooks-on-opendbchannel-fetch" class="sidebar-link">Hooks on openDBChannel / fetch</a></li><li class="sidebar-sub-header"><a href="/vuex-easy-firestore/hooks.html#execution-timings-of-hooks" class="sidebar-link">Execution timings of hooks</a></li></ul></li><li><a href="/vuex-easy-firestore/extra-features.html" class="active sidebar-link">Extra features</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuex-easy-firestore/extra-features.html#variables-for-firestorepath-or-clauses" class="sidebar-link">Variables for firestorePath or clauses</a></li><li class="sidebar-sub-header"><a href="/vuex-easy-firestore/extra-features.html#fillables-and-guard" class="sidebar-link">Fillables and guard</a></li><li class="sidebar-sub-header"><a href="/vuex-easy-firestore/extra-features.html#default-values" class="sidebar-link">Default values</a></li><li class="sidebar-sub-header"><a href="/vuex-easy-firestore/extra-features.html#firestore-timestamp-conversion" class="sidebar-link">Firestore Timestamp conversion</a></li><li class="sidebar-sub-header"><a href="/vuex-easy-firestore/extra-features.html#pass-firebase-dependency" class="sidebar-link">Pass Firebase dependency</a></li><li class="sidebar-sub-header"><a href="/vuex-easy-firestore/extra-features.html#custom-sync-debounce-duration" class="sidebar-link">Custom sync debounce duration</a></li></ul></li><li><a href="/vuex-easy-firestore/faq.html" class="sidebar-link">FAQ</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuex-easy-firestore/faq.html#firebase-error-app-duplicate-service" class="sidebar-link">Firebase Error app/duplicate-service</a></li></ul></li><li><a href="/vuex-easy-firestore/config-example.html" class="sidebar-link">Config example</a></li><li><a href="/vuex-easy-firestore/feedback.html" class="sidebar-link">Feedback</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="extra-features"><a href="#extra-features" class="header-anchor">#</a> Extra features</h1> <h2 id="variables-for-firestorepath-or-clauses"><a href="#variables-for-firestorepath-or-clauses" class="header-anchor">#</a> Variables for firestorePath or clauses</h2> <p>Besides <code>'{userId}'</code> in your <code>firestorePath</code> in the config or in <code>where</code> clauses, you can also use <strong>any variable</strong> in the <code>firestorePath</code> or the <code>where</code> filter.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// your vuex module</span>
SpecificGroupUserModule<span class="token operator">:</span> <span class="token punctuation">{</span>
  firestorePath<span class="token operator">:</span> <span class="token string">'groups/{groupId}/users/{userId}'</span><span class="token punctuation">,</span>
  moduleName<span class="token operator">:</span> <span class="token string">'groupUserData'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><p>You can replace a path variable with the actual string by:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 1. Passing it as a parameter to openDBChannel</span>
<span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'groupUserData/openDBChannel'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>pathVariables<span class="token operator">:</span> <span class="token punctuation">{</span>groupId<span class="token operator">:</span> <span class="token string">'group-A'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 2. Passing it as a parameter to fetchAndAdd</span>
<span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'groupUserData/fetchAndAdd'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>pathVariables<span class="token operator">:</span> <span class="token punctuation">{</span>groupId<span class="token operator">:</span> <span class="token string">'group-A'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 3. Dispatching setPathVars</span>
<span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'groupUserData/setPathVars'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>groupId<span class="token operator">:</span> <span class="token string">'group-A'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>Always clear out your Vuex module before you change a path variable. You can do so by:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'moduleName/closeDBChannel'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>clearModule<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// or just</span>
<span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">'moduleName/RESET_VUEX_EASY_FIRESTORE_STATE'</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="warning-do-not-overuse-path-variables"><a href="#warning-do-not-overuse-path-variables" class="header-anchor">#</a> Warning: Do not overuse path variables!</h3> <p>The original intend of Vuex Easy Firestore is to have <em>1 Firestore path</em> in sync with <em>1 Vuex module</em>. Changing a path variable means that <strong>each following patch/insert/deletion will use that path</strong>.</p> <p>Only the last path variable you passed to a module is kept! So you cannot add documents from several different paths (eg. you call <code>fetchAndAdd</code> three times with different path variables provided) and still expect to be able to modify all these docs.</p> <h3 id="use-case-retrieve-a-variable-from-the-user-s-data"><a href="#use-case-retrieve-a-variable-from-the-user-s-data" class="header-anchor">#</a> Use case: Retrieve a variable from the user's Data</h3> <p>Custom variables are useful however, if you need to first retrieve eg. a <code>groupId</code> from the user's data also on firestore. You can do so by waiting for the Promise to resolve after <code>openDBChannel</code> to retrieve the user's data (eg. another vuex-easy-firestore module called <code>userData</code>):</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// in this example the `userData` module will retrieve {userName: '', groupId: ''}</span>
store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'userData/openDBChannel'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">_</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// Then we can get the groupId:</span>
    <span class="token keyword">const</span> userGroupId <span class="token operator">=</span> store<span class="token punctuation">.</span>state<span class="token punctuation">.</span>userData<span class="token punctuation">.</span>groupId
    <span class="token comment">// Then we can pass it as variable to the next openDBChannel:</span>
    store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'groupUserData/openDBChannel'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>pathVariables<span class="token operator">:</span> <span class="token punctuation">{</span>groupId<span class="token operator">:</span> userGroupId<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="use-case-retrieve-data-based-on-the-vue-router-path"><a href="#use-case-retrieve-data-based-on-the-vue-router-path" class="header-anchor">#</a> Use case: Retrieve data based on the Vue Router path</h3> <p>This is a great use case! But it has a good and a bad implementation. I'll go over both so you can see what I mean:</p> <h4 id="bad-implementation-of-vue-router"><a href="#bad-implementation-of-vue-router" class="header-anchor">#</a> Bad implementation of Vue Router</h4> <p>Do <strong>not</strong> use use a path variable as last param of a FirestorePath in 'doc' mode! Eg:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// DO NOT DO THIS!</span>
SpecificGroupUserModule<span class="token operator">:</span> <span class="token punctuation">{</span>
  firestorePath<span class="token operator">:</span> <span class="token string">'pages/{pageId}'</span><span class="token punctuation">,</span>
  firestoreRefType<span class="token operator">:</span> <span class="token string">'doc'</span><span class="token punctuation">,</span>
  moduleName<span class="token operator">:</span> <span class="token string">'page'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token comment">// in your Vue file (DO NOT DO THIS!)</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">created</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> pageId <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$route<span class="token punctuation">.</span>params<span class="token punctuation">.</span>id
    <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'page/fetchAndAdd'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>pathVariables<span class="token operator">:</span> <span class="token punctuation">{</span>pageId<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  computed<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">openDoc</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span>state<span class="token punctuation">.</span>page
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>The above example shows a Vuex module linked to a single doc, but this path is changed every time the user opens a page and then the doc is retrieved.
When opening a new page you will need to release the previous doc from memory every time, so when the user goes back you will be charged with a read again.</p> <h4 id="good-implementation-of-vue-router"><a href="#good-implementation-of-vue-router" class="header-anchor">#</a> Good implementation of Vue Router</h4> <p>Instead, use 'collection' mode! This way you can keep the pages that were opened already and opening those pages again is much faster. That implementation would look like this:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// MUCH BETTER:</span>
SpecificGroupUserModule<span class="token operator">:</span> <span class="token punctuation">{</span>
  firestorePath<span class="token operator">:</span> <span class="token string">'pages'</span><span class="token punctuation">,</span>
  firestoreRefType<span class="token operator">:</span> <span class="token string">'collection'</span><span class="token punctuation">,</span>
  moduleName<span class="token operator">:</span> <span class="token string">'pageData'</span><span class="token punctuation">,</span>
  statePropName<span class="token operator">:</span> <span class="token string">'data'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token comment">// in your Vue file</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">created</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> pageId <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$route<span class="token punctuation">.</span>params<span class="token punctuation">.</span>id
    <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'pages/fetchById'</span><span class="token punctuation">,</span> pageId<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  computed<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">openDoc</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> pageId <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$route<span class="token punctuation">.</span>params<span class="token punctuation">.</span>id
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span>state<span class="token punctuation">.</span>pages<span class="token punctuation">.</span>data<span class="token punctuation">[</span>pageId<span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="fillables-and-guard"><a href="#fillables-and-guard" class="header-anchor">#</a> Fillables and guard</h2> <p>You can prevent props on your docs to be synced to the firestore server. For this you should use either <code>fillables</code> <strong>or</strong> <code>guard</code>:</p> <ul><li><em>Fillables:</em> Array of keys - the props which <strong>may be synced</strong> to the server.
<ul><li>0 fillables = all props are synced</li> <li>1 or more fillables = only those props are synced (any prop not in fillables is not synced)</li></ul></li> <li><em>Guard:</em> Array of keys - the props which <strong>should not be synced</strong> to the server.
<ul><li>adding any prop here will prevent it from being synced</li></ul></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
  <span class="token comment">// your other vuex-easy-fire config...</span>
  sync<span class="token operator">:</span> <span class="token punctuation">{</span>
    fillables<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// array of  keys</span>
    guard<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// array of keys</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="example-fillables"><a href="#example-fillables" class="header-anchor">#</a> Example fillables</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// settings:</span>
fillables<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token string">'age'</span><span class="token punctuation">]</span>

<span class="token comment">// insert new doc:</span>
<span class="token keyword">const</span> newUser <span class="token operator">=</span> <span class="token punctuation">{</span>name<span class="token operator">:</span> <span class="token string">'Ash'</span><span class="token punctuation">,</span> age<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span> email<span class="token operator">:</span> <span class="token string">'ash@pokemon.com'</span><span class="token punctuation">}</span>
<span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'user/set'</span><span class="token punctuation">,</span> newUser<span class="token punctuation">)</span>

<span class="token comment">// object which will be added to Vuex `user` module:</span>
<span class="token punctuation">{</span>name<span class="token operator">:</span> <span class="token string">'Ash'</span><span class="token punctuation">,</span> age<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span> email<span class="token operator">:</span> <span class="token string">'ash@pokemon.com'</span><span class="token punctuation">}</span>

<span class="token comment">// object which will be synced to firestore:</span>
<span class="token punctuation">{</span>name<span class="token operator">:</span> <span class="token string">'Ash'</span><span class="token punctuation">,</span> age<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">}</span>
</code></pre></div><h3 id="example-guard"><a href="#example-guard" class="header-anchor">#</a> Example guard</h3> <p>If you have only one prop you do not want to sync to firestore you can set <code>guard</code> instead of <code>fillables</code>.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// the same example as above can also be achieved by doing:</span>
guard<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'email'</span><span class="token punctuation">]</span>
</code></pre></div><h3 id="nested-fillables-guard"><a href="#nested-fillables-guard" class="header-anchor">#</a> Nested fillables/guard</h3> <p>In the example below we will prevent the nested field called <code>notAllowed</code> from being synced:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> docToPatch <span class="token operator">=</span> <span class="token punctuation">{</span>nested<span class="token operator">:</span> <span class="token punctuation">{</span>allowed<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> notAllowed<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">}</span>

<span class="token comment">// in your module config, either set the fillables like so:</span>
fillables<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'nested.allowed'</span><span class="token punctuation">]</span>

<span class="token comment">// OR set your guard like so:</span>
guard<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'nested.notAllowed'</span><span class="token punctuation">]</span>
</code></pre></div><h3 id="wildcard-fillables-guard"><a href="#wildcard-fillables-guard" class="header-anchor">#</a> Wildcard fillables/guard</h3> <p>You can also use wildcards!</p> <p>In this example you have a document with an object called <code>lists</code>. The lists each have an id as the key, and a nested property you want to prevent from being synced:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> docToPatch <span class="token operator">=</span> <span class="token punctuation">{</span>
  lists<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">'list-id1'</span><span class="token operator">:</span> <span class="token punctuation">{</span>allowed<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> notAllowed<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string">'list-id2'</span><span class="token operator">:</span> <span class="token punctuation">{</span>allowed<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> notAllowed<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// in your module config, either set the fillables like so:</span>
fillables<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'lists.*.allowed'</span><span class="token punctuation">]</span>

<span class="token comment">// OR set your guard like so:</span>
guard<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'lists.*.notAllowed'</span><span class="token punctuation">]</span>
</code></pre></div><h2 id="default-values"><a href="#default-values" class="header-anchor">#</a> Default values</h2> <p>You can set up default values for your docs that will be added to the object on each insert.</p> <p><strong>In 'doc' mode</strong> this can just be done by adding those values to your module state. This is how's it's done regularly with Vuex.</p> <p><strong>In 'collection' mode</strong> the library takes care of applying these default values to each doc that's inserted. Default values should be set in your modules <code>sync</code> config:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> pokemonBoxModule <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// your other vuex-easy-firestore config...</span>
  sync<span class="token operator">:</span> <span class="token punctuation">{</span>
    defaultValues<span class="token operator">:</span> <span class="token punctuation">{</span>
      freed<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// Now, when you add a new pokemon, it will automatically have `freed`</span>
<span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'pokemonBox/insert'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>name<span class="token operator">:</span> <span class="token string">'Poliwag'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// This will appear in your module like so:</span>
<span class="token comment">// {name: 'Poliwag', freed: false}</span>
</code></pre></div><p>Also, to make sure there are no vue reactivity issues, these default values are also applied to any doc that doesn't have them that's retrieved from the server.</p> <h2 id="firestore-timestamp-conversion"><a href="#firestore-timestamp-conversion" class="header-anchor">#</a> Firestore Timestamp conversion</h2> <p>Firestore works with special &quot;<a href="https://firebase.google.com/docs/reference/js/firebase.firestore.Timestamp" target="_blank" rel="noopener noreferrer">timestamp<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>&quot; fields rather than with <code>new Date()</code>. The general rule is: <strong>If you set or update a field to be <code>new Date()</code> it will be converted to a special Timestamp field on the server automatically.</strong></p> <p>There is nothing you can do to prevent this, it's just how Firestore works. The problem is that next time a user opens your app and your documents are retrieved from the server, you will be getting Timestamps and have to call <code>timestamp.toDate()</code> on each of these fields!</p> <p><strong>Luckily vuex-easy-firestore can do this for you!</strong> This library has date fields for <code>created_at</code> and <code>updated_at</code> that are already automatically converted to regular dates upon server retrieval. So we can easily extend this function to include other fields you want to use <code>new Date()</code>.</p> <p>You just have to specify the fields in a <code>convertTimestamps</code> object in your module config like so:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> vuexModule <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// your other vuex-easy-firestore config...</span>
  serverChange<span class="token operator">:</span> <span class="token punctuation">{</span>
    convertTimestamps<span class="token operator">:</span> <span class="token punctuation">{</span>
      created_at<span class="token operator">:</span> <span class="token string">'%convertTimestamp%'</span><span class="token punctuation">,</span> <span class="token comment">// default</span>
      updated_at<span class="token operator">:</span> <span class="token string">'%convertTimestamp%'</span><span class="token punctuation">,</span> <span class="token comment">// default</span>
      <span class="token comment">// define each field like so ‚Üë in an object here</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>The Timestamps of each of the fields defined like above will automatically trigger <code>Timestamp.toDate()</code> before being added to your vuex store!</p> <p>Eg.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'module/set'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>timestampField<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>The above will be added as <code>new Date()</code> in vuex but as a <em>timestamp</em> in Firestore.</p> <h2 id="pass-firebase-dependency"><a href="#pass-firebase-dependency" class="header-anchor">#</a> Pass Firebase dependency</h2> <p>Vuex Easy Firestore will automatically use Firebase as a peer dependency to access <code>Firebase.auth()</code> etc. If you want to pass a Firebase instance you have instantiated yourself you can do so like this:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// make sure you import at least auth and firestore as well:</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> Firebase <span class="token keyword">from</span> <span class="token string">'firebase/app'</span>
<span class="token keyword">import</span> <span class="token string">'firebase/auth'</span>
<span class="token keyword">import</span> <span class="token string">'firebase/firestore'</span>

<span class="token keyword">import</span> createEasyFirestore <span class="token keyword">from</span> <span class="token string">'vuex-easy-firestore'</span>
<span class="token keyword">const</span> easyFirestore <span class="token operator">=</span> <span class="token function">createEasyFirestore</span><span class="token punctuation">(</span>
  userDataModule<span class="token punctuation">,</span>
  <span class="token punctuation">{</span>logging<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> FirebaseDependency<span class="token operator">:</span> Firebase<span class="token punctuation">}</span> <span class="token comment">// pass Firebase like this. Mind the Capital F!</span>
<span class="token punctuation">)</span>
</code></pre></div><h2 id="custom-sync-debounce-duration"><a href="#custom-sync-debounce-duration" class="header-anchor">#</a> Custom sync debounce duration</h2> <p>Vuex easy firestore only makes one api call per 1000ms, no matter how many patches you make. This default debounce duration of 1000ms can be modified per module like so:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> vuexModule <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// your other vuex-easy-firestore config...</span>
  sync<span class="token operator">:</span> <span class="token punctuation">{</span>
    debounceTimerMs<span class="token operator">:</span> <span class="token number">2000</span>
    <span class="token comment">// defaults to 1000</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/mesqueeb/vuex-easy-firestore/edit/dev/docs/extra-features.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ‚Üê
      <a href="/vuex-easy-firestore/hooks.html" class="prev">
        Hooks
      </a></span> <span class="next"><a href="/vuex-easy-firestore/faq.html">
        FAQ
      </a>
      ‚Üí
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/vuex-easy-firestore/assets/js/app.7865803c.js" defer></script><script src="/vuex-easy-firestore/assets/js/2.a44a5bbe.js" defer></script><script src="/vuex-easy-firestore/assets/js/8.14128c0a.js" defer></script>
  </body>
</html>
